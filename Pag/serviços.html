<!DOCTYPE html>
<html lang="pt-PT">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HS-CONEXÕES | Serviços</title>
  <link rel="icon" href="../img/icon.png" type="image/png">
  <link rel="stylesheet" href="../css/cs.css" />
  <link rel="stylesheet" href="../css/serviços.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    .container { padding: 30px; }
    .services { display: grid; grid-template-columns: repeat(auto-fit,minmax(250px,1fr)); gap: 20px; margin-top: 20px; }
    .service-item { padding: 20px; background:#f5f5f5; border-radius:10px; text-align:center; box-shadow:0 2px 8px rgba(0,0,0,0.1);}
    .service-item i { font-size:40px; margin-bottom:10px; color:#007bff; }
    .service-item h3 { margin:10px 0; }
    .cta-btn { padding: 10px 15px; background:#007bff; color:#fff; border:none; border-radius:8px; cursor:pointer; }
    .cta-btn:hover { background:#0056b3; }

    /* Modal */
    .modal { display:none; position:fixed; z-index:1000; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; }
    .modal-content { background:#fff; padding:25px; border-radius:12px; width:90%; max-width:500px; position:relative; box-shadow:0 4px 12px rgba(0,0,0,0.2);}
    .close { position:absolute; top:10px; right:15px; font-size:1.5rem; cursor:pointer; }
    .modal form { display:flex; flex-direction:column; gap:12px; }
    .modal input, .modal textarea, .modal select { padding:10px; border-radius:8px; border:1px solid #ccc; font-size:14px; width:100%; }
    .modal button { padding:10px; border:none; background:#007bff; color:white; border-radius:8px; cursor:pointer; font-size:16px; }
    .modal button:hover { background:#0056b3; }

    /* Alerta estilizado */
    .custom-alert {
      display: none;
      position: fixed;
      top: 20px;
      right: 20px;
      background: #007bff;
      color: #fff;
      padding: 15px 20px;
      border-radius: 8px;
      z-index: 2000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      animation: fadein 0.3s;
    }
    .custom-alert .alert-content { display: flex; align-items: center; gap: 10px; }
    .custom-alert button { background: #0056b3; border: none; color: #fff; padding: 5px 10px; border-radius: 6px; cursor: pointer; }
    @keyframes fadein { from { opacity: 0; transform: translateY(-10px);} to { opacity: 1; transform: translateY(0);} }
  </style>
</head>
<body>

<!-- Navbar simplificado -->
<nav class="navbar">
  <div class="logo">HS Conexões</div>
  <ul class="nav-links">
    <li><a href="../index.html">Início</a></li>
    <li><a class="active">Serviços</a></li>
    <li><a href="../Pag/Sobre.html">Sobre Nós</a></li>
  </ul>
</nav>
<br><br><br>

<div class="container">
  <h1 class="title">Nossos Serviços</h1>
  <p class="subtitle">Conectando seu mundo através de soluções inovadoras em tecnologia e infraestrutura.</p>
  <section class="services" id="services-container"></section>
</div>

<!-- Modal -->
<div id="serviceModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2 id="modal-title">Solicitar Serviço</h2>
    <form id="service-form">
      <div id="form-fields"></div>
      <button type="submit">Enviar Solicitação</button>
    </form>
  </div>
</div>

<!-- Alerta estilizado -->
<div id="custom-alert" class="custom-alert">
  <div class="alert-content">
    <p id="alert-message">Mensagem de alerta</p>
    <button onclick="fecharAlerta()">OK</button>
  </div>
</div>

<script>
  const services = [
    {
      nome: "Consultoria de TI",
      descricao: "Melhoramos sua infraestrutura tecnológica.",
      campos: [
        { tipo: "text", nome: "nome", placeholder: "Seu Nome", required:true },
        { tipo: "email", nome: "email", placeholder: "Seu Email", required:true },
        { tipo: "textarea", nome: "detalhes", placeholder: "Descreva seu projeto", required:true }
      ]
    },
    {
      nome: "Designer Gráfico",
      descricao: "Criação de identidade visual e design profissional.",
      campos: [
        { tipo: "text", nome: "nome", placeholder: "Seu Nome", required:true },
        { tipo: "email", nome: "email", placeholder: "Seu Email", required:true },
        { tipo: "textarea", nome: "detalhes", placeholder: "Tipo de design desejado", required:true }
      ]
    },
    {
      nome: "Help Desk e Hardware",
      descricao: "Suporte técnico especializado.",
      campos: [
        { tipo: "text", nome: "nome", placeholder: "Seu Nome", required:true },
        { tipo: "email", nome: "email", placeholder: "Seu Email", required:true },
        { tipo: "textarea", nome: "problema", placeholder: "Descreva o problema", required:true }
      ]
    },
    {
      nome: "Infraestrutura de Rede",
      descricao: "Planejamento e implementação de redes.",
      campos: [
        { tipo: "text", nome: "nome", placeholder: "Seu Nome", required:true },
        { tipo: "email", nome: "email", placeholder: "Seu Email", required:true },
        { tipo: "textarea", nome: "detalhes", placeholder: "Descrição da rede", required:true }
      ]
    },
    {
      nome: "Cibersegurança",
      descricao: "Proteção avançada contra ataques.",
      campos: [
        { tipo: "text", nome: "nome", placeholder: "Seu Nome", required:true },
        { tipo: "email", nome: "email", placeholder: "Seu Email", required:true },
        { tipo: "textarea", nome: "detalhes", placeholder: "Descrição do serviço desejado", required:true }
      ]
    },
    {
      nome: "Registro de Domínios",
      descricao: "Registrar domínio para seu site.",
      campos: [
        { tipo: "text", nome: "nome", placeholder: "Seu Nome", required:true },
        { tipo: "email", nome: "email", placeholder: "Seu Email", required:true },
        { tipo: "text", nome: "dominio", placeholder: "Nome do domínio desejado", required:true }
      ]
    },
    {
      nome: "Criação de Websites",
      descricao: "Desenvolvimento completo de sites.",
      campos: [
        { tipo: "text", nome: "nome", placeholder: "Seu Nome", required:true },
        { tipo: "email", nome: "email", placeholder: "Seu Email", required:true },
        { tipo: "textarea", nome: "detalhes", placeholder: "Descrição do site desejado", required:true },
        { tipo: "select", nome: "tipo", options:["Landing Page","E-commerce","Portfólio","Outro"], required:true }
      ]
    }
  ];

  const servicesContainer = document.getElementById('services-container');
  const modal = document.getElementById('serviceModal');
  const closeModal = document.querySelector('.close');
  const modalTitle = document.getElementById('modal-title');
  const formFields = document.getElementById('form-fields');
  const form = document.getElementById('service-form');

  // Renderizar serviços
  services.forEach(s => {
    const div = document.createElement('div');
    div.className = 'service-item';
    div.innerHTML = `
      <i class="fas fa-cogs"></i>
      <h3>${s.nome}</h3>
      <p>${s.descricao}</p>
      <button class="cta-btn">Solicitar</button>
    `;
    div.querySelector('button').addEventListener('click', () => openModal(s));
    servicesContainer.appendChild(div);
  });

  function openModal(servico) {
    modal.style.display = 'flex';
    modalTitle.innerText = `Solicitar: ${servico.nome}`;
    formFields.innerHTML = '';
    servico.campos.forEach(c => {
      let field;
      if(c.tipo === 'textarea'){
        field = document.createElement('textarea');
        field.name = c.nome;
        field.placeholder = c.placeholder;
        field.required = c.required;
      } else if(c.tipo === 'select'){
        field = document.createElement('select');
        field.name = c.nome;
        field.required = c.required;
        c.options.forEach(opt => {
          const option = document.createElement('option');
          option.value = opt;
          option.text = opt;
          field.appendChild(option);
        });
      } else {
        field = document.createElement('input');
        field.type = c.tipo;
        field.name = c.nome;
        field.placeholder = c.placeholder;
        field.required = c.required;
      }
      formFields.appendChild(field);
    });
  }

  closeModal.addEventListener('click', () => modal.style.display = 'none');
  window.addEventListener('click', e => { if(e.target === modal) modal.style.display = 'none'; });

  form.addEventListener('submit', async e => {
    e.preventDefault();
    const data = Object.fromEntries(new FormData(form).entries());
    data.servico = modalTitle.innerText.replace("Solicitar: ","");

    try {
      const response = await fetch('/.netlify/functions/enviar-email', {
        method: 'POST',
        body: JSON.stringify(data),
      });
      const result = await response.json();
      if(response.ok){
        mostrarAlerta(result.message);
      } else {
        mostrarAlerta("Erro ao enviar solicitação: " + result.erro);
      }
      modal.style.display = 'none';
      form.reset();
    } catch(err){
      mostrarAlerta("Erro ao enviar solicitação: " + err.message);
    }
  });

  // Funções do alerta
  function mostrarAlerta(mensagem){
    const alerta = document.getElementById('custom-alert');
    const mensagemElem = document.getElementById('alert-message');
    mensagemElem.innerText = mensagem;
    alerta.style.display = 'flex';
    setTimeout(() => { alerta.style.display = 'none'; }, 5000);
  }
  function fecharAlerta(){ document.getElementById('custom-alert').style.display = 'none'; }
</script>
</body>
</html>
